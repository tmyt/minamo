extends ../_base

block vars
  - var pageTitle = 'console'

block links
  link(rel='prerender', href='/logstream')

block scripts
  script(src='https://cdnjs.cloudflare.com/ajax/libs/react/15.3.2/react.min.js', defer)
  script(src='https://cdnjs.cloudflare.com/ajax/libs/react/15.3.2/react-dom.min.js', defer)
  script(src='https://cdnjs.cloudflare.com/ajax/libs/react-bootstrap/0.30.3/react-bootstrap.min.js', defer)
  script(src='https://cdn.socket.io/socket.io-1.4.5.js', defer)
  script(src='//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js', defer)
  script(src='/api/config.js', defer)
  script(src='/js/console.js', defer)

block styles
  link(rel='stylesheet', href='//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css')
  meta(name='apple-mobile-web-app-capable', content='yes')
  meta(name='apple-mobile-web-app-status-bar-style', content='black')

block header-nav
  li: a.active(href='/console') console
  li: a(href='/console/logstream') log stream

block navbar-addon
  #console-tab: .container: ul.nav.nav-tabs.nav-static-top
    li.active: a(href='#tab-statuses', data-toggle='tab') statuses
    li: a(href='#tab-create', data-toggle='tab') create
    li: a(href='#tab-configure', data-toggle='tab') configure

block content
  .tab-content
    .tab-pane.fade.in.active#tab-statuses
      h2 Container status
      #statuses

    .tab-pane.fade#tab-create
      h2 Create containers
      form#newform(name='new_container')
        #service_name_group.form-group.has-feedback
          label(for='service_name') Name
          input#service_name.form-control(type='text', name='service')
          span#service_name_glyph.glyphicon.form-control-feedback
          span#errmsg.help-block.text-danger
        #template_group.form-group
          label(for='template') Template
          select#template.form-control(name='template')
            option(value='') Blank
            option(value='simple-webapi') SimpleWebAPI
            option(value='express-pug') ExpressPug
        #external_repo_group.form-group
          label(for='external_repo') External Repository (optional)
          input#external_repo.form-control(type='text', name='external')
        input.btn.btn-primary(type='submit', value='create')

    .tab-pane.fade#tab-configure
      h2 Configure credentials
      form#credentialform(name='credential_configure')
        #username_group.form-group
          label(for='username') Git Username
          input#username.form-control(type='text', name='password', disabled='disabled', value=profile.username)
        #password_group.form-group
          label(for='password') Git Password
          input#password.form-control(type='text', name='password')
        input.btn.btn-primary(type='submit', value='update')

      #config_ios
        h2 for iOS
        p navigate to this link and add to home, you can use fullscreen console.
        p: a(href=ios_url) auto login console

  #envconfig_frame.modal.fade(role='dialog')
    .modal-dialog: .modal-content
      .modal-header
        h4 Env config
      .modal-body
        form
          input#target_service(type='hidden', name='service')
          table#envlist.table.table-hover
            thead: tr
              th name
              th value
            tr
              td: input.form-control
              td: input.form-control
              td: button.btn.btn-danger.form-control
                span.glyphicon.glyphicon-trash
            tr
              td(colspan=3): button.btn.btn-default.form-control add new
      .modal-footer
        button#env_save.btn.btn-primary(data-dismiss='modal') save
        button.btn.btn-default(data-dismiss='modal') cancel

  #logs_frame.modal.fade(role='dialog')
    .modal-dialog: .modal-content
      .modal-header: h4 Logs
      .modal-body
        textarea#logs.form-control(rows='15', readonly)
      .modal-footer
        button.btn.btn-default(data-dismiss='modal') close 

block extra_content
  script().
    if(!!navigator.platform && /iPad|iPhone|iPod/.test(navigator.platform)){
      $('#config_ios').css('display', 'block');
    }
